<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1">

    <title>WebPivotTable Component</title>

    <style type="text/css">
        html,
        body,
        #wpt-container {
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
        }
    </style>

    <script type="text/javascript" src="#wptJs#"></script>
</head>

<body>
    <div id="wpt-container">
        <web-pivot-table />
    </div>

    <script>
    var wpt = document.getElementsByTagName('web-pivot-table')[0];

    wpt.setOptions({
        localeFilePath: "#localeFilePath#",
      locale: "#locale#",
      availableLocales: [{
        value: 'en', abbr: 'EN', label:'Lbl_English', attach:" ( english ) "
        },{
        value: 'zh-CN', abbr: 'CN', label:'Lbl_Chinese', attach:" ( 简体 ) "
        },{
        value: 'zh-HK', abbr: 'HK', label:'Lbl_Chinese', attach:" ( 香港繁體 ) "
        },{
        value: 'zh-TW', abbr: 'TW', label:'Lbl_Chinese', attach:" ( 台灣繁體 ) "
      }],
      leavePageWarning: 0,
      server: {
        fileProxyEnabled: 0,
        fileProxy: "https://rt2020api.nxstudio.com",
        fileTimeout: 300000,
        xmlaProxyEnabled: 0
      },
      fileLinks: [],
    });

    //wpt.setWptFromLocalFile('SA1340.wpt', wpt.Constants.sourceType.WPT);  // 唔啱用，因為點會知道 local file path 呢？

    //wpt.setWptFromWptUrl("https://webpivottable.com/testfiles/file631.wpt");  // WebPivotTable 官網提供嘅測試檔案

    wpt.setWptFromWptUrl("#wptUrl#");   // 可以先做隻 冇 data 嘅 Wpt，入面有埋 data Url。個 hashtag 係準備喺 runtime 嘅時候用真正嘅 file Url 嚟 replace

    //wpt.setWptFromCsvUrl('https://rt2020api.nxstudio.com/api/Wpt/getWptFile/SA1340.csv/');    // 淨係 data，要自己搞 Pivot UI

    wpt.addEventListener("EVENT_DRILL_THROUGH", function (event) {
      console.log("drill through happens", event);
    })
    </script>
</body>

</html>