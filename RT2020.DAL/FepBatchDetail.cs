using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Data.Common;
using System.Data.SqlClient;
using System.Data.SqlTypes;
using System.Reflection;
using System.Text;
using Gizmox.WebGUI.Forms;
using System.Xml;

using Microsoft.Practices.EnterpriseLibrary.Data;

namespace RT2020.DAL
{
    /// <summary>
    /// This Data Access Layer Component (DALC) provides access to the data contained in the data table dbo.FepBatchDetail.
    /// Date Created:   2020-08-09 02:14:09
    /// Created By:     Generated by CodeSmith version 7.0.0.15123
    /// Template:       BusinessObjects_v5.0.cst
    /// </summary>
    public class FepBatchDetail
    {
        private Guid key = Guid.Empty;
        private Guid detailsId = Guid.Empty;
        private Guid headerId = Guid.Empty;
        private string txType = String.Empty;
        private string txNumber = String.Empty;
        private DateTime txDate = DateTime.Parse("1900-1-1");
        private int lineNumber = 0;
        private Guid productId = Guid.Empty;
        private string sHOP = String.Empty;
        private string tERMINAL = String.Empty;
        private string oPERATOR = String.Empty;
        private decimal qTY;
        private decimal uAMT;
        private decimal dISC;
        private decimal aMOUNT;
        private decimal aVRCOST;
        private decimal bASPRC;
        private string rEF = String.Empty;
        private string bARCODE = String.Empty;
        private string sERIALNO = String.Empty;
        private string vITEM = String.Empty;
        private string cOUPONNO = String.Empty;
        private decimal pROPRC;
        private decimal dISC_2;
        private string dISC_INDICATOR = String.Empty;
        private short rEPLENISH;
        private decimal dISC_VIPAMT;
        private decimal dISC_MARKDOWN;
        private decimal dISC_ITEMAMT;
        private string dISC_ITEMTYPE = String.Empty;
        private string dISC_ITEMREF = String.Empty;
        private decimal dISC_ALLAMT;
        private string dISC_ALLTYPE = String.Empty;
        private string dISC_ALLREF1 = String.Empty;
        private string dISC_ALLREF2 = String.Empty;
        private string dISC_ALLREF3 = String.Empty;
        private string dISCOUNTCODE = String.Empty;
        private decimal aMT_TTLSALES;
        private decimal aMT_NETSALES;
        private decimal aMT_TAX;
        private decimal cONFIRM_TRF_QTY;
        private string fLAG_DELIVERY = String.Empty;
        private string cONFIRM_DELIVERY = String.Empty;
        private DateTime cONFIRM_DATE = DateTime.Parse("1900-1-1");
        private string cONFIRM_USER = String.Empty;

        /// <summary>
        /// Initialize an new empty FepBatchDetail object.
        /// </summary>
        public FepBatchDetail()
        {
        }
		
        /// <summary>
        /// Initialize a new FepBatchDetail object with the given parameters.
        /// </summary>
        public FepBatchDetail(Guid detailsId, Guid headerId, string txType, string txNumber, DateTime txDate, int lineNumber, Guid productId, string sHOP, string tERMINAL, string oPERATOR, decimal qTY, decimal uAMT, decimal dISC, decimal aMOUNT, decimal aVRCOST, decimal bASPRC, string rEF, string bARCODE, string sERIALNO, string vITEM, string cOUPONNO, decimal pROPRC, decimal dISC_2, string dISC_INDICATOR, short rEPLENISH, decimal dISC_VIPAMT, decimal dISC_MARKDOWN, decimal dISC_ITEMAMT, string dISC_ITEMTYPE, string dISC_ITEMREF, decimal dISC_ALLAMT, string dISC_ALLTYPE, string dISC_ALLREF1, string dISC_ALLREF2, string dISC_ALLREF3, string dISCOUNTCODE, decimal aMT_TTLSALES, decimal aMT_NETSALES, decimal aMT_TAX, decimal cONFIRM_TRF_QTY, string fLAG_DELIVERY, string cONFIRM_DELIVERY, DateTime cONFIRM_DATE, string cONFIRM_USER)
        {
                this.detailsId = detailsId;
                this.headerId = headerId;
                this.txType = txType;
                this.txNumber = txNumber;
                this.txDate = txDate;
                this.lineNumber = lineNumber;
                this.productId = productId;
                this.sHOP = sHOP;
                this.tERMINAL = tERMINAL;
                this.oPERATOR = oPERATOR;
                this.qTY = qTY;
                this.uAMT = uAMT;
                this.dISC = dISC;
                this.aMOUNT = aMOUNT;
                this.aVRCOST = aVRCOST;
                this.bASPRC = bASPRC;
                this.rEF = rEF;
                this.bARCODE = bARCODE;
                this.sERIALNO = sERIALNO;
                this.vITEM = vITEM;
                this.cOUPONNO = cOUPONNO;
                this.pROPRC = pROPRC;
                this.dISC_2 = dISC_2;
                this.dISC_INDICATOR = dISC_INDICATOR;
                this.rEPLENISH = rEPLENISH;
                this.dISC_VIPAMT = dISC_VIPAMT;
                this.dISC_MARKDOWN = dISC_MARKDOWN;
                this.dISC_ITEMAMT = dISC_ITEMAMT;
                this.dISC_ITEMTYPE = dISC_ITEMTYPE;
                this.dISC_ITEMREF = dISC_ITEMREF;
                this.dISC_ALLAMT = dISC_ALLAMT;
                this.dISC_ALLTYPE = dISC_ALLTYPE;
                this.dISC_ALLREF1 = dISC_ALLREF1;
                this.dISC_ALLREF2 = dISC_ALLREF2;
                this.dISC_ALLREF3 = dISC_ALLREF3;
                this.dISCOUNTCODE = dISCOUNTCODE;
                this.aMT_TTLSALES = aMT_TTLSALES;
                this.aMT_NETSALES = aMT_NETSALES;
                this.aMT_TAX = aMT_TAX;
                this.cONFIRM_TRF_QTY = cONFIRM_TRF_QTY;
                this.fLAG_DELIVERY = fLAG_DELIVERY;
                this.cONFIRM_DELIVERY = cONFIRM_DELIVERY;
                this.cONFIRM_DATE = cONFIRM_DATE;
                this.cONFIRM_USER = cONFIRM_USER;
        }	
		
        /// <summary>
        /// Loads a FepBatchDetail object from the database using the given DetailsId
        /// </summary>
        /// <param name="detailsId">The primary key value</param>
        /// <returns>A FepBatchDetail object</returns>
        public static FepBatchDetail Load(Guid detailsId)
        {
            SqlParameter[] parameterValues = new SqlParameter[] { new SqlParameter("@DetailsId", detailsId) };
            using (SqlDataReader reader = SqlHelper.Default.ExecuteReader("spFepBatchDetail_SelRec", parameterValues))
            {
                if (reader.Read())
                {
                    FepBatchDetail result = new FepBatchDetail();
                    result.LoadFromReader(reader);
                    return result;
                }
                else
                    return null;
            }
        }

        /// <summary>
        /// Loads a FepBatchDetail object from the database using the given where clause
        /// </summary>
        /// <param name="whereClause">The filter expression for the query</param>
        /// <returns>A FepBatchDetail object</returns>
        public static FepBatchDetail LoadWhere(string whereClause)
        {
            SqlParameter[] parameterValues = new SqlParameter[] { new SqlParameter("@WhereClause", whereClause) };
            using (SqlDataReader reader = SqlHelper.Default.ExecuteReader("spFepBatchDetail_SelAll", parameterValues))
            {
                if (reader.Read())
                {
                    FepBatchDetail result = new FepBatchDetail();
                    result.LoadFromReader(reader);
                    return result;
                }
                else
                    return null;
            }
        }
		
        /// <summary>
        /// Loads a collection of FepBatchDetail objects from the database.
        /// </summary>
        /// <returns>A collection containing all of the FepBatchDetail objects in the database.</returns>
        public static FepBatchDetailCollection LoadCollection()
        {
            SqlParameter[] parms = new SqlParameter[] {};
            return LoadCollection("spFepBatchDetail_SelAll", parms);
        }

        /// <summary>
        /// Loads a collection of FepBatchDetail objects from the database ordered by the columns specified.
        /// </summary>
        /// <returns>A collection containing all of the FepBatchDetail objects in the database ordered by the columns specified.</returns>
        public static FepBatchDetailCollection LoadCollection(string[] orderByColumns, bool ascending)
        {
            StringBuilder orderClause = new StringBuilder();
            for (int i = 0; i < orderByColumns.Length; i++)
            {
                orderClause.Append(orderByColumns[i]);

                if (i != orderByColumns.Length-1)
                    orderClause.Append(", ");
            }

            if (ascending)
                orderClause.Append(" ASC");
            else
                orderClause.Append(" DESC");

            SqlParameter[] parms = new SqlParameter[] { new SqlParameter("@OrderBy", orderClause.ToString()) };
            return LoadCollection("spFepBatchDetail_SelAll", parms);
        }

        /// <summary>
        /// Loads a collection of FepBatchDetail objects from the database.
        /// </summary>
        /// <returns>A collection containing all of the FepBatchDetail objects in the database.</returns>
        public static FepBatchDetailCollection LoadCollection(string whereClause)
        {
            SqlParameter[] parms = new SqlParameter[] { new SqlParameter("@WhereClause", whereClause) };
            return LoadCollection("spFepBatchDetail_SelAll", parms);
        }

        /// <summary>
        /// Loads a collection of FepBatchDetail objects from the database ordered by the columns specified.
        /// </summary>
        /// <returns>A collection containing all of the FepBatchDetail objects in the database ordered by the columns specified.</returns>
        public static FepBatchDetailCollection LoadCollection(string whereClause, string[] orderByColumns, bool ascending)
        {
            StringBuilder orderClause = new StringBuilder();
            for (int i = 0; i < orderByColumns.Length; i++)
            {
                orderClause.Append(orderByColumns[i]);

                if (i != orderByColumns.Length-1)
                    orderClause.Append(", ");
            }

            if (ascending)
                orderClause.Append(" ASC");
            else
                orderClause.Append(" DESC");

            SqlParameter[] parms = new SqlParameter[] { new SqlParameter("@WhereClause", whereClause), new SqlParameter("@OrderBy", orderClause.ToString()) };
            return LoadCollection("spFepBatchDetail_SelAll", parms);
        }

        /// <summary>
        /// Loads a collection of FepBatchDetail objects from the database.
        /// </summary>
        /// <returns>A collection containing all of the FepBatchDetail objects in the database.</returns>
        public static FepBatchDetailCollection LoadCollection(string spName, SqlParameter[] parms)
        {
            FepBatchDetailCollection result = new FepBatchDetailCollection();
            using (SqlDataReader reader = SqlHelper.Default.ExecuteReader(spName, parms))
            {
                while (reader.Read())
                {
                    FepBatchDetail tmp = new FepBatchDetail();
                    tmp.LoadFromReader(reader);
                    result.Add(tmp);
                }
            }
            return result;
        }

        /// <summary>
        /// Deletes a FepBatchDetail object from the database.
        /// </summary>
        /// <param name="detailsId">The primary key value</param>
        public static void Delete(Guid detailsId)
        {
            SqlParameter[] parameterValues = new SqlParameter[] { new SqlParameter("@DetailsId", detailsId) };
            SqlHelper.Default.ExecuteNonQuery("spFepBatchDetail_DelRec", parameterValues);
        }

		
        public void LoadFromReader(SqlDataReader reader)
        {
            if (reader != null && !reader.IsClosed)
            {
                key = reader.GetGuid(0);
                if (!reader.IsDBNull(0)) detailsId = reader.GetGuid(0);
                if (!reader.IsDBNull(1)) headerId = reader.GetGuid(1);
                if (!reader.IsDBNull(2)) txType = reader.GetString(2);
                if (!reader.IsDBNull(3)) txNumber = reader.GetString(3);
                if (!reader.IsDBNull(4)) txDate = reader.GetDateTime(4);
                if (!reader.IsDBNull(5)) lineNumber = reader.GetInt32(5);
                if (!reader.IsDBNull(6)) productId = reader.GetGuid(6);
                if (!reader.IsDBNull(7)) sHOP = reader.GetString(7);
                if (!reader.IsDBNull(8)) tERMINAL = reader.GetString(8);
                if (!reader.IsDBNull(9)) oPERATOR = reader.GetString(9);
                if (!reader.IsDBNull(10)) qTY = reader.GetDecimal(10);
                if (!reader.IsDBNull(11)) uAMT = reader.GetDecimal(11);
                if (!reader.IsDBNull(12)) dISC = reader.GetDecimal(12);
                if (!reader.IsDBNull(13)) aMOUNT = reader.GetDecimal(13);
                if (!reader.IsDBNull(14)) aVRCOST = reader.GetDecimal(14);
                if (!reader.IsDBNull(15)) bASPRC = reader.GetDecimal(15);
                if (!reader.IsDBNull(16)) rEF = reader.GetString(16);
                if (!reader.IsDBNull(17)) bARCODE = reader.GetString(17);
                if (!reader.IsDBNull(18)) sERIALNO = reader.GetString(18);
                if (!reader.IsDBNull(19)) vITEM = reader.GetString(19);
                if (!reader.IsDBNull(20)) cOUPONNO = reader.GetString(20);
                if (!reader.IsDBNull(21)) pROPRC = reader.GetDecimal(21);
                if (!reader.IsDBNull(22)) dISC_2 = reader.GetDecimal(22);
                if (!reader.IsDBNull(23)) dISC_INDICATOR = reader.GetString(23);
                if (!reader.IsDBNull(24)) rEPLENISH = reader.GetInt16(24);
                if (!reader.IsDBNull(25)) dISC_VIPAMT = reader.GetDecimal(25);
                if (!reader.IsDBNull(26)) dISC_MARKDOWN = reader.GetDecimal(26);
                if (!reader.IsDBNull(27)) dISC_ITEMAMT = reader.GetDecimal(27);
                if (!reader.IsDBNull(28)) dISC_ITEMTYPE = reader.GetString(28);
                if (!reader.IsDBNull(29)) dISC_ITEMREF = reader.GetString(29);
                if (!reader.IsDBNull(30)) dISC_ALLAMT = reader.GetDecimal(30);
                if (!reader.IsDBNull(31)) dISC_ALLTYPE = reader.GetString(31);
                if (!reader.IsDBNull(32)) dISC_ALLREF1 = reader.GetString(32);
                if (!reader.IsDBNull(33)) dISC_ALLREF2 = reader.GetString(33);
                if (!reader.IsDBNull(34)) dISC_ALLREF3 = reader.GetString(34);
                if (!reader.IsDBNull(35)) dISCOUNTCODE = reader.GetString(35);
                if (!reader.IsDBNull(36)) aMT_TTLSALES = reader.GetDecimal(36);
                if (!reader.IsDBNull(37)) aMT_NETSALES = reader.GetDecimal(37);
                if (!reader.IsDBNull(38)) aMT_TAX = reader.GetDecimal(38);
                if (!reader.IsDBNull(39)) cONFIRM_TRF_QTY = reader.GetDecimal(39);
                if (!reader.IsDBNull(40)) fLAG_DELIVERY = reader.GetString(40);
                if (!reader.IsDBNull(41)) cONFIRM_DELIVERY = reader.GetString(41);
                if (!reader.IsDBNull(42)) cONFIRM_DATE = reader.GetDateTime(42);
                if (!reader.IsDBNull(43)) cONFIRM_USER = reader.GetString(43);
            }
        }
		
        public void Delete()
        {
            Delete(this.DetailsId);
        }

        public void Save()
        {
            //  We use the key field which will have its default value unless it is set by Load(). When we save we can know if
            //  we need to do an insert (key == null) an update (key == primaryKey) or a 
            //  delete+update (key != null && key != primaryKey)

            if (key == Guid.Empty)
                Insert();
            else
            {
                if (key != DetailsId)
                    this.Delete();
                Update();
            }
        }

        public Guid DetailsId
        {
            get { return detailsId; }
            set { detailsId = value; }
        }

        public Guid HeaderId
        {
            get { return headerId; }
            set { headerId = value; }
        }

        public string TxType
        {
            get { return txType; }
            set { txType = value; }
        }

        public string TxNumber
        {
            get { return txNumber; }
            set { txNumber = value; }
        }

        public DateTime TxDate
        {
            get { return txDate; }
            set { txDate = value; }
        }

        public int LineNumber
        {
            get { return lineNumber; }
            set { lineNumber = value; }
        }

        public Guid ProductId
        {
            get { return productId; }
            set { productId = value; }
        }

        public string SHOP
        {
            get { return sHOP; }
            set { sHOP = value; }
        }

        public string TERMINAL
        {
            get { return tERMINAL; }
            set { tERMINAL = value; }
        }

        public string OPERATOR
        {
            get { return oPERATOR; }
            set { oPERATOR = value; }
        }

        public decimal QTY
        {
            get { return qTY; }
            set { qTY = value; }
        }

        public decimal UAMT
        {
            get { return uAMT; }
            set { uAMT = value; }
        }

        public decimal DISC
        {
            get { return dISC; }
            set { dISC = value; }
        }

        public decimal AMOUNT
        {
            get { return aMOUNT; }
            set { aMOUNT = value; }
        }

        public decimal AVRCOST
        {
            get { return aVRCOST; }
            set { aVRCOST = value; }
        }

        public decimal BASPRC
        {
            get { return bASPRC; }
            set { bASPRC = value; }
        }

        public string REF
        {
            get { return rEF; }
            set { rEF = value; }
        }

        public string BARCODE
        {
            get { return bARCODE; }
            set { bARCODE = value; }
        }

        public string SERIALNO
        {
            get { return sERIALNO; }
            set { sERIALNO = value; }
        }

        public string VITEM
        {
            get { return vITEM; }
            set { vITEM = value; }
        }

        public string COUPONNO
        {
            get { return cOUPONNO; }
            set { cOUPONNO = value; }
        }

        public decimal PROPRC
        {
            get { return pROPRC; }
            set { pROPRC = value; }
        }

        public decimal DISC_2
        {
            get { return dISC_2; }
            set { dISC_2 = value; }
        }

        public string DISC_INDICATOR
        {
            get { return dISC_INDICATOR; }
            set { dISC_INDICATOR = value; }
        }

        public short REPLENISH
        {
            get { return rEPLENISH; }
            set { rEPLENISH = value; }
        }

        public decimal DISC_VIPAMT
        {
            get { return dISC_VIPAMT; }
            set { dISC_VIPAMT = value; }
        }

        public decimal DISC_MARKDOWN
        {
            get { return dISC_MARKDOWN; }
            set { dISC_MARKDOWN = value; }
        }

        public decimal DISC_ITEMAMT
        {
            get { return dISC_ITEMAMT; }
            set { dISC_ITEMAMT = value; }
        }

        public string DISC_ITEMTYPE
        {
            get { return dISC_ITEMTYPE; }
            set { dISC_ITEMTYPE = value; }
        }

        public string DISC_ITEMREF
        {
            get { return dISC_ITEMREF; }
            set { dISC_ITEMREF = value; }
        }

        public decimal DISC_ALLAMT
        {
            get { return dISC_ALLAMT; }
            set { dISC_ALLAMT = value; }
        }

        public string DISC_ALLTYPE
        {
            get { return dISC_ALLTYPE; }
            set { dISC_ALLTYPE = value; }
        }

        public string DISC_ALLREF1
        {
            get { return dISC_ALLREF1; }
            set { dISC_ALLREF1 = value; }
        }

        public string DISC_ALLREF2
        {
            get { return dISC_ALLREF2; }
            set { dISC_ALLREF2 = value; }
        }

        public string DISC_ALLREF3
        {
            get { return dISC_ALLREF3; }
            set { dISC_ALLREF3 = value; }
        }

        public string DISCOUNTCODE
        {
            get { return dISCOUNTCODE; }
            set { dISCOUNTCODE = value; }
        }

        public decimal AMT_TTLSALES
        {
            get { return aMT_TTLSALES; }
            set { aMT_TTLSALES = value; }
        }

        public decimal AMT_NETSALES
        {
            get { return aMT_NETSALES; }
            set { aMT_NETSALES = value; }
        }

        public decimal AMT_TAX
        {
            get { return aMT_TAX; }
            set { aMT_TAX = value; }
        }

        public decimal CONFIRM_TRF_QTY
        {
            get { return cONFIRM_TRF_QTY; }
            set { cONFIRM_TRF_QTY = value; }
        }

        public string FLAG_DELIVERY
        {
            get { return fLAG_DELIVERY; }
            set { fLAG_DELIVERY = value; }
        }

        public string CONFIRM_DELIVERY
        {
            get { return cONFIRM_DELIVERY; }
            set { cONFIRM_DELIVERY = value; }
        }

        public DateTime CONFIRM_DATE
        {
            get { return cONFIRM_DATE; }
            set { cONFIRM_DATE = value; }
        }

        public string CONFIRM_USER
        {
            get { return cONFIRM_USER; }
            set { cONFIRM_USER = value; }
        }


        private void Insert()
        {
            SqlParameter[] parameterValues = GetInsertParameterValues();
            object returnedValue = null;
			
            SqlHelper.Default.ExecuteNonQuery("spFepBatchDetail_InsRec", "@DetailsId", out returnedValue, parameterValues);
            
            detailsId = returnedValue != null ? (Guid)returnedValue : Guid.Empty;
            key = returnedValue != null ? (Guid)returnedValue : Guid.Empty;
        }

        private void Update()
        {
            SqlParameter[] parameterValues = GetUpdateParameterValues();
            
			SqlHelper.Default.ExecuteNonQuery("spFepBatchDetail_UpdRec", parameterValues);
        }
        
        /// <summary>
        /// Gets the SQL parameter.
        /// </summary>
        /// <param name="name">The name.</param>
        /// <param name="direction">The direction.</param>
        /// <param name="dbType">Type of the db.</param>
        /// <param name="size">The size.</param>
        /// <param name="value">The value.</param>
        /// <returns></returns>
        private SqlParameter GetSqlParameter(string name, ParameterDirection direction, SqlDbType dbType, int size, object value)
        {
            SqlParameter p = new SqlParameter(name, dbType, size);
            p.Value = value;
            p.Direction = direction;
            return p;
        }

        private SqlParameter[] GetInsertParameterValues()
        {
            SqlParameter[] prams = new SqlParameter[44];
            prams[0] = GetSqlParameter("@DetailsId", ParameterDirection.Output, SqlDbType.UniqueIdentifier, 16, this.DetailsId);
            prams[1] = GetSqlParameter("@HeaderId", ParameterDirection.Input, SqlDbType.UniqueIdentifier, 16, this.HeaderId);
            prams[2] = GetSqlParameter("@TxType", ParameterDirection.Input, SqlDbType.VarChar, 3, this.TxType);
            prams[3] = GetSqlParameter("@TxNumber", ParameterDirection.Input, SqlDbType.VarChar, 12, this.TxNumber);
            prams[4] = GetSqlParameter("@TxDate", ParameterDirection.Input, SqlDbType.DateTime, 8, this.TxDate);
            prams[5] = GetSqlParameter("@LineNumber", ParameterDirection.Input, SqlDbType.Int, 4, this.LineNumber);
            prams[6] = GetSqlParameter("@ProductId", ParameterDirection.Input, SqlDbType.UniqueIdentifier, 16, this.ProductId);
            prams[7] = GetSqlParameter("@SHOP", ParameterDirection.Input, SqlDbType.VarChar, 4, this.SHOP);
            prams[8] = GetSqlParameter("@TERMINAL", ParameterDirection.Input, SqlDbType.VarChar, 2, this.TERMINAL);
            prams[9] = GetSqlParameter("@OPERATOR", ParameterDirection.Input, SqlDbType.VarChar, 4, this.OPERATOR);
            prams[10] = GetSqlParameter("@QTY", ParameterDirection.Input, SqlDbType.Decimal, 9, this.QTY);
            prams[11] = GetSqlParameter("@UAMT", ParameterDirection.Input, SqlDbType.Money, 8, this.UAMT);
            prams[12] = GetSqlParameter("@DISC", ParameterDirection.Input, SqlDbType.Decimal, 5, this.DISC);
            prams[13] = GetSqlParameter("@AMOUNT", ParameterDirection.Input, SqlDbType.Money, 8, this.AMOUNT);
            prams[14] = GetSqlParameter("@AVRCOST", ParameterDirection.Input, SqlDbType.Money, 8, this.AVRCOST);
            prams[15] = GetSqlParameter("@BASPRC", ParameterDirection.Input, SqlDbType.Money, 8, this.BASPRC);
            prams[16] = GetSqlParameter("@REF", ParameterDirection.Input, SqlDbType.VarChar, 12, this.REF);
            prams[17] = GetSqlParameter("@BARCODE", ParameterDirection.Input, SqlDbType.VarChar, 22, this.BARCODE);
            prams[18] = GetSqlParameter("@SERIALNO", ParameterDirection.Input, SqlDbType.VarChar, 20, this.SERIALNO);
            prams[19] = GetSqlParameter("@VITEM", ParameterDirection.Input, SqlDbType.VarChar, 20, this.VITEM);
            prams[20] = GetSqlParameter("@COUPONNO", ParameterDirection.Input, SqlDbType.VarChar, 30, this.COUPONNO);
            prams[21] = GetSqlParameter("@PROPRC", ParameterDirection.Input, SqlDbType.Money, 8, this.PROPRC);
            prams[22] = GetSqlParameter("@DISC_2", ParameterDirection.Input, SqlDbType.Money, 8, this.DISC_2);
            prams[23] = GetSqlParameter("@DISC_INDICATOR", ParameterDirection.Input, SqlDbType.VarChar, 5, this.DISC_INDICATOR);
            prams[24] = GetSqlParameter("@REPLENISH", ParameterDirection.Input, SqlDbType.SmallInt, 2, this.REPLENISH);
            prams[25] = GetSqlParameter("@DISC_VIPAMT", ParameterDirection.Input, SqlDbType.Money, 8, this.DISC_VIPAMT);
            prams[26] = GetSqlParameter("@DISC_MARKDOWN", ParameterDirection.Input, SqlDbType.Money, 8, this.DISC_MARKDOWN);
            prams[27] = GetSqlParameter("@DISC_ITEMAMT", ParameterDirection.Input, SqlDbType.Money, 8, this.DISC_ITEMAMT);
            prams[28] = GetSqlParameter("@DISC_ITEMTYPE", ParameterDirection.Input, SqlDbType.VarChar, 4, this.DISC_ITEMTYPE);
            prams[29] = GetSqlParameter("@DISC_ITEMREF", ParameterDirection.Input, SqlDbType.VarChar, 12, this.DISC_ITEMREF);
            prams[30] = GetSqlParameter("@DISC_ALLAMT", ParameterDirection.Input, SqlDbType.Money, 8, this.DISC_ALLAMT);
            prams[31] = GetSqlParameter("@DISC_ALLTYPE", ParameterDirection.Input, SqlDbType.VarChar, 4, this.DISC_ALLTYPE);
            prams[32] = GetSqlParameter("@DISC_ALLREF1", ParameterDirection.Input, SqlDbType.VarChar, 12, this.DISC_ALLREF1);
            prams[33] = GetSqlParameter("@DISC_ALLREF2", ParameterDirection.Input, SqlDbType.VarChar, 12, this.DISC_ALLREF2);
            prams[34] = GetSqlParameter("@DISC_ALLREF3", ParameterDirection.Input, SqlDbType.VarChar, 12, this.DISC_ALLREF3);
            prams[35] = GetSqlParameter("@DISCOUNTCODE", ParameterDirection.Input, SqlDbType.VarChar, 30, this.DISCOUNTCODE);
            prams[36] = GetSqlParameter("@AMT_TTLSALES", ParameterDirection.Input, SqlDbType.Money, 8, this.AMT_TTLSALES);
            prams[37] = GetSqlParameter("@AMT_NETSALES", ParameterDirection.Input, SqlDbType.Money, 8, this.AMT_NETSALES);
            prams[38] = GetSqlParameter("@AMT_TAX", ParameterDirection.Input, SqlDbType.Money, 8, this.AMT_TAX);
            prams[39] = GetSqlParameter("@CONFIRM_TRF_QTY", ParameterDirection.Input, SqlDbType.Decimal, 9, this.CONFIRM_TRF_QTY);
            prams[40] = GetSqlParameter("@FLAG_DELIVERY", ParameterDirection.Input, SqlDbType.VarChar, 1, this.FLAG_DELIVERY);
            prams[41] = GetSqlParameter("@CONFIRM_DELIVERY", ParameterDirection.Input, SqlDbType.VarChar, 1, this.CONFIRM_DELIVERY);
            prams[42] = GetSqlParameter("@CONFIRM_DATE", ParameterDirection.Input, SqlDbType.DateTime, 8, this.CONFIRM_DATE);
            prams[43] = GetSqlParameter("@CONFIRM_USER", ParameterDirection.Input, SqlDbType.VarChar, 4, this.CONFIRM_USER);
            return prams;
        }
		
        /// <summary>
        /// Gets the SQL parameter without direction.
        /// </summary>
        /// <param name="name">The name.</param>
        /// <param name="dbType">Type of the db.</param>
        /// <param name="size">The size.</param>
        /// <param name="value">The value.</param>
        /// <returns></returns>
        private SqlParameter GetSqlParameterWithoutDirection(string name, SqlDbType dbType, int size, object value)
        {
            SqlParameter p = new SqlParameter(name, dbType, size);
            p.Value = value;
            return p;
        }
        
        private SqlParameter[] GetUpdateParameterValues()
        {
            return new SqlParameter[] 
            {
                GetSqlParameterWithoutDirection("@DetailsId", SqlDbType.UniqueIdentifier, 16, this.DetailsId),
                GetSqlParameterWithoutDirection("@HeaderId", SqlDbType.UniqueIdentifier, 16, this.HeaderId),
                GetSqlParameterWithoutDirection("@TxType", SqlDbType.VarChar, 3, this.TxType),
                GetSqlParameterWithoutDirection("@TxNumber", SqlDbType.VarChar, 12, this.TxNumber),
                GetSqlParameterWithoutDirection("@TxDate", SqlDbType.DateTime, 8, this.TxDate),
                GetSqlParameterWithoutDirection("@LineNumber", SqlDbType.Int, 4, this.LineNumber),
                GetSqlParameterWithoutDirection("@ProductId", SqlDbType.UniqueIdentifier, 16, this.ProductId),
                GetSqlParameterWithoutDirection("@SHOP", SqlDbType.VarChar, 4, this.SHOP),
                GetSqlParameterWithoutDirection("@TERMINAL", SqlDbType.VarChar, 2, this.TERMINAL),
                GetSqlParameterWithoutDirection("@OPERATOR", SqlDbType.VarChar, 4, this.OPERATOR),
                GetSqlParameterWithoutDirection("@QTY", SqlDbType.Decimal, 9, this.QTY),
                GetSqlParameterWithoutDirection("@UAMT", SqlDbType.Money, 8, this.UAMT),
                GetSqlParameterWithoutDirection("@DISC", SqlDbType.Decimal, 5, this.DISC),
                GetSqlParameterWithoutDirection("@AMOUNT", SqlDbType.Money, 8, this.AMOUNT),
                GetSqlParameterWithoutDirection("@AVRCOST", SqlDbType.Money, 8, this.AVRCOST),
                GetSqlParameterWithoutDirection("@BASPRC", SqlDbType.Money, 8, this.BASPRC),
                GetSqlParameterWithoutDirection("@REF", SqlDbType.VarChar, 12, this.REF),
                GetSqlParameterWithoutDirection("@BARCODE", SqlDbType.VarChar, 22, this.BARCODE),
                GetSqlParameterWithoutDirection("@SERIALNO", SqlDbType.VarChar, 20, this.SERIALNO),
                GetSqlParameterWithoutDirection("@VITEM", SqlDbType.VarChar, 20, this.VITEM),
                GetSqlParameterWithoutDirection("@COUPONNO", SqlDbType.VarChar, 30, this.COUPONNO),
                GetSqlParameterWithoutDirection("@PROPRC", SqlDbType.Money, 8, this.PROPRC),
                GetSqlParameterWithoutDirection("@DISC_2", SqlDbType.Money, 8, this.DISC_2),
                GetSqlParameterWithoutDirection("@DISC_INDICATOR", SqlDbType.VarChar, 5, this.DISC_INDICATOR),
                GetSqlParameterWithoutDirection("@REPLENISH", SqlDbType.SmallInt, 2, this.REPLENISH),
                GetSqlParameterWithoutDirection("@DISC_VIPAMT", SqlDbType.Money, 8, this.DISC_VIPAMT),
                GetSqlParameterWithoutDirection("@DISC_MARKDOWN", SqlDbType.Money, 8, this.DISC_MARKDOWN),
                GetSqlParameterWithoutDirection("@DISC_ITEMAMT", SqlDbType.Money, 8, this.DISC_ITEMAMT),
                GetSqlParameterWithoutDirection("@DISC_ITEMTYPE", SqlDbType.VarChar, 4, this.DISC_ITEMTYPE),
                GetSqlParameterWithoutDirection("@DISC_ITEMREF", SqlDbType.VarChar, 12, this.DISC_ITEMREF),
                GetSqlParameterWithoutDirection("@DISC_ALLAMT", SqlDbType.Money, 8, this.DISC_ALLAMT),
                GetSqlParameterWithoutDirection("@DISC_ALLTYPE", SqlDbType.VarChar, 4, this.DISC_ALLTYPE),
                GetSqlParameterWithoutDirection("@DISC_ALLREF1", SqlDbType.VarChar, 12, this.DISC_ALLREF1),
                GetSqlParameterWithoutDirection("@DISC_ALLREF2", SqlDbType.VarChar, 12, this.DISC_ALLREF2),
                GetSqlParameterWithoutDirection("@DISC_ALLREF3", SqlDbType.VarChar, 12, this.DISC_ALLREF3),
                GetSqlParameterWithoutDirection("@DISCOUNTCODE", SqlDbType.VarChar, 30, this.DISCOUNTCODE),
                GetSqlParameterWithoutDirection("@AMT_TTLSALES", SqlDbType.Money, 8, this.AMT_TTLSALES),
                GetSqlParameterWithoutDirection("@AMT_NETSALES", SqlDbType.Money, 8, this.AMT_NETSALES),
                GetSqlParameterWithoutDirection("@AMT_TAX", SqlDbType.Money, 8, this.AMT_TAX),
                GetSqlParameterWithoutDirection("@CONFIRM_TRF_QTY", SqlDbType.Decimal, 9, this.CONFIRM_TRF_QTY),
                GetSqlParameterWithoutDirection("@FLAG_DELIVERY", SqlDbType.VarChar, 1, this.FLAG_DELIVERY),
                GetSqlParameterWithoutDirection("@CONFIRM_DELIVERY", SqlDbType.VarChar, 1, this.CONFIRM_DELIVERY),
                GetSqlParameterWithoutDirection("@CONFIRM_DATE", SqlDbType.DateTime, 8, this.CONFIRM_DATE),
                GetSqlParameterWithoutDirection("@CONFIRM_USER", SqlDbType.VarChar, 4, this.CONFIRM_USER)
            };
        }

        public override string ToString()
        {
            StringBuilder builder = new StringBuilder();
            builder.Append("detailsId: " + detailsId.ToString()).Append("\r\n");
            builder.Append("headerId: " + headerId.ToString()).Append("\r\n");
            builder.Append("txType: " + txType.ToString()).Append("\r\n");
            builder.Append("txNumber: " + txNumber.ToString()).Append("\r\n");
            builder.Append("txDate: " + txDate.ToString()).Append("\r\n");
            builder.Append("lineNumber: " + lineNumber.ToString()).Append("\r\n");
            builder.Append("productId: " + productId.ToString()).Append("\r\n");
            builder.Append("sHOP: " + sHOP.ToString()).Append("\r\n");
            builder.Append("tERMINAL: " + tERMINAL.ToString()).Append("\r\n");
            builder.Append("oPERATOR: " + oPERATOR.ToString()).Append("\r\n");
            builder.Append("qTY: " + qTY.ToString()).Append("\r\n");
            builder.Append("uAMT: " + uAMT.ToString()).Append("\r\n");
            builder.Append("dISC: " + dISC.ToString()).Append("\r\n");
            builder.Append("aMOUNT: " + aMOUNT.ToString()).Append("\r\n");
            builder.Append("aVRCOST: " + aVRCOST.ToString()).Append("\r\n");
            builder.Append("bASPRC: " + bASPRC.ToString()).Append("\r\n");
            builder.Append("rEF: " + rEF.ToString()).Append("\r\n");
            builder.Append("bARCODE: " + bARCODE.ToString()).Append("\r\n");
            builder.Append("sERIALNO: " + sERIALNO.ToString()).Append("\r\n");
            builder.Append("vITEM: " + vITEM.ToString()).Append("\r\n");
            builder.Append("cOUPONNO: " + cOUPONNO.ToString()).Append("\r\n");
            builder.Append("pROPRC: " + pROPRC.ToString()).Append("\r\n");
            builder.Append("dISC_2: " + dISC_2.ToString()).Append("\r\n");
            builder.Append("dISC_INDICATOR: " + dISC_INDICATOR.ToString()).Append("\r\n");
            builder.Append("rEPLENISH: " + rEPLENISH.ToString()).Append("\r\n");
            builder.Append("dISC_VIPAMT: " + dISC_VIPAMT.ToString()).Append("\r\n");
            builder.Append("dISC_MARKDOWN: " + dISC_MARKDOWN.ToString()).Append("\r\n");
            builder.Append("dISC_ITEMAMT: " + dISC_ITEMAMT.ToString()).Append("\r\n");
            builder.Append("dISC_ITEMTYPE: " + dISC_ITEMTYPE.ToString()).Append("\r\n");
            builder.Append("dISC_ITEMREF: " + dISC_ITEMREF.ToString()).Append("\r\n");
            builder.Append("dISC_ALLAMT: " + dISC_ALLAMT.ToString()).Append("\r\n");
            builder.Append("dISC_ALLTYPE: " + dISC_ALLTYPE.ToString()).Append("\r\n");
            builder.Append("dISC_ALLREF1: " + dISC_ALLREF1.ToString()).Append("\r\n");
            builder.Append("dISC_ALLREF2: " + dISC_ALLREF2.ToString()).Append("\r\n");
            builder.Append("dISC_ALLREF3: " + dISC_ALLREF3.ToString()).Append("\r\n");
            builder.Append("dISCOUNTCODE: " + dISCOUNTCODE.ToString()).Append("\r\n");
            builder.Append("aMT_TTLSALES: " + aMT_TTLSALES.ToString()).Append("\r\n");
            builder.Append("aMT_NETSALES: " + aMT_NETSALES.ToString()).Append("\r\n");
            builder.Append("aMT_TAX: " + aMT_TAX.ToString()).Append("\r\n");
            builder.Append("cONFIRM_TRF_QTY: " + cONFIRM_TRF_QTY.ToString()).Append("\r\n");
            builder.Append("fLAG_DELIVERY: " + fLAG_DELIVERY.ToString()).Append("\r\n");
            builder.Append("cONFIRM_DELIVERY: " + cONFIRM_DELIVERY.ToString()).Append("\r\n");
            builder.Append("cONFIRM_DATE: " + cONFIRM_DATE.ToString()).Append("\r\n");
            builder.Append("cONFIRM_USER: " + cONFIRM_USER.ToString()).Append("\r\n");
            builder.Append("\r\n");
            return builder.ToString();
        }	
		
		#region Load ComboBox
        /// <summary>
        /// Only support the ComboBox control from WinForm/Visual WebGUI
        /// </summary>
        /// <param name="ddList">the ComboBox control from WinForm/Visual WebGUI</param>
        /// <param name="TextField">e.g. "FieldName"</param>
        /// <param name="SwitchLocale">Can be localized, if the FieldName has locale suffix, e.g. '_chs'</param>
		public static void LoadCombo(ref ComboBox ddList, string TextField, bool SwitchLocale)
		{
			LoadCombo(ref ddList, TextField, SwitchLocale, false, string.Empty, string.Empty, new string[]{ TextField });
		}
		
        /// <summary>
        /// Only support the ComboBox control from WinForm/Visual WebGUI
        /// </summary>
        /// <param name="ddList">the ComboBox control from WinForm/Visual WebGUI</param>
        /// <param name="TextField">e.g. "FieldName"</param>
        /// <param name="SwitchLocale">Can be localized, if the FieldName has locale suffix, e.g. '_chs'</param>
        /// <param name="OrderBy">Sorting order, string array, e.g. {"FieldName1", "FiledName2"}</param>
		public static void LoadCombo(ref ComboBox ddList, string TextField, bool SwitchLocale, string[] OrderBy)
		{
			LoadCombo(ref ddList, TextField, SwitchLocale, false, string.Empty, string.Empty, OrderBy);
		}

        /// <summary>
        /// Only support the ComboBox control from WinForm/Visual WebGUI
        /// </summary>
        /// <param name="ddList">the ComboBox control from WinForm/Visual WebGUI</param>
        /// <param name="TextField">e.g. "FieldName"</param>
        /// <param name="SwitchLocale">Can be localized, if the FieldName has locale suffix, e.g. '_chs'</param>
        /// <param name="BlankLine">add blank label text to ComboBox or not</param>
        /// <param name="BlankLineText">the blank label text</param>
        /// <param name="WhereClause">Where Clause for SQL Statement. e.g. "FieldName = 'SomeCondition'"</param>
		public static void LoadCombo(ref ComboBox ddList, string TextField, bool SwitchLocale, bool BlankLine, string BlankLineText, string WhereClause)
		{
			LoadCombo(ref ddList, TextField, SwitchLocale, BlankLine, BlankLineText, string.Empty, WhereClause, new String[] { TextField });
		}

        /// <summary>
        /// Only support the ComboBox control from WinForm/Visual WebGUI
        /// </summary>
        /// <param name="ddList">the ComboBox control from WinForm/Visual WebGUI</param>
        /// <param name="TextField">e.g. "FieldName"</param>
        /// <param name="SwitchLocale">Can be localized, if the FieldName has locale suffix, e.g. '_chs'</param>
        /// <param name="BlankLine">add blank label text to ComboBox or not</param>
        /// <param name="BlankLineText">the blank label text</param>
        /// <param name="WhereClause">Where Clause for SQL Statement. e.g. "FieldName = 'SomeCondition'"</param>
        /// <param name="OrderBy">Sorting order, string array, e.g. {"FieldName1", "FiledName2"}</param>
		public static void LoadCombo(ref ComboBox ddList, string TextField, bool SwitchLocale, bool BlankLine, string BlankLineText, string WhereClause, string[] OrderBy)
		{
			LoadCombo(ref ddList, TextField, SwitchLocale, BlankLine, BlankLineText, string.Empty, WhereClause, OrderBy);
		}

        /// <summary>
        /// Only support the ComboBox control from WinForm/Visual WebGUI
        /// </summary>
        /// <param name="ddList">the ComboBox control from WinForm/Visual WebGUI</param>
        /// <param name="TextField">e.g. "FieldName"</param>
        /// <param name="SwitchLocale">Can be localized, if the FieldName has locale suffix, e.g. '_chs'</param>
        /// <param name="BlankLine">add blank label text to ComboBox or not</param>
        /// <param name="BlankLineText">the blank label text</param>
        /// <param name="ParentFilter">e.g. "ForeignFieldName = 'value'"</param>
        /// <param name="WhereClause">Where Clause for SQL Statement. e.g. "FieldName = 'SomeCondition'"</param>
        /// <param name="OrderBy">Sorting order, string array, e.g. {"FieldName1", "FiledName2"}</param>
		public static void LoadCombo(ref ComboBox ddList, string TextField, bool SwitchLocale, bool BlankLine, string BlankLineText, string ParentFilter, string WhereClause, string[] OrderBy)
		{
			string [] textField = {TextField};
			LoadCombo(ref ddList, textField, "{0}", SwitchLocale, BlankLine, BlankLineText, ParentFilter, WhereClause, OrderBy);
		}

        /// <summary>
        /// Only support the ComboBox control from WinForm/Visual WebGUI
        /// </summary>
        /// <param name="ddList">the ComboBox control from WinForm/Visual WebGUI</param>
        /// <param name="TextField">e.g. new string[]{"FieldName1", "FieldName2", ...}</param>
        /// <param name="TextFormatString">e.g. "{0} - {1}"</param>
        /// <param name="SwitchLocale">Can be localized, if the FieldName has locale suffix, e.g. '_chs'</param>
        /// <param name="BlankLine">add blank label text to ComboBox or not</param>
        /// <param name="BlankLineText">the blank label text</param>
        /// <param name="WhereClause">Where Clause for SQL Statement. e.g. "FieldName = 'SomeCondition'"</param>
        /// <param name="OrderBy">Sorting order, string array, e.g. {"FieldName1", "FiledName2"}</param>
		public static void LoadCombo(ref ComboBox ddList, string [] TextField, string TextFormatString, bool SwitchLocale, bool BlankLine, string BlankLineText, string WhereClause, string[] OrderBy)
		{
			LoadCombo(ref ddList, TextField, TextFormatString, SwitchLocale, BlankLine, BlankLineText, string.Empty, WhereClause, OrderBy);
		}
		
        /// <summary>
        /// Only support the ComboBox control from WinForm/Visual WebGUI
        /// </summary>
        /// <param name="ddList">the ComboBox control from WinForm/Visual WebGUI</param>
        /// <param name="TextField">e.g. new string[]{"FieldName1", "FieldName2", ...}</param>
        /// <param name="TextFormatString">e.g. "{0} - {1}"</param>
        /// <param name="SwitchLocale">Can be localized, if the FieldName has locale suffix, e.g. '_chs'</param>
        /// <param name="BlankLine">add blank label text to ComboBox or not</param>
        /// <param name="BlankLineText">the blank label text</param>
        /// <param name="ParentFilter">e.g. "ForeignFieldName = 'value'"</param>
        /// <param name="WhereClause">Where Clause for SQL Statement. e.g. "FieldName = 'SomeCondition'"</param>
        /// <param name="OrderBy">Sorting order, string array, e.g. {"FieldName1", "FiledName2"}</param>
		public static void LoadCombo(ref ComboBox ddList, string [] TextField, string TextFormatString, bool SwitchLocale, bool BlankLine, string BlankLineText, string ParentFilter, string WhereClause, string[] OrderBy)
		{
			if (SwitchLocale)
			{
				TextField = GetSwitchLocale(TextField);
			}
			ddList.Items.Clear();						
			
			FepBatchDetailCollection source;
            
            if(OrderBy == null || OrderBy.Length == 0)
            {
			    OrderBy = TextField;
            }
			
			if (WhereClause.Length > 0)
			{
				source = FepBatchDetail.LoadCollection(WhereClause, OrderBy, true);
			}
			else
			{
				source = FepBatchDetail.LoadCollection(OrderBy, true);
			}
			
            Common.ComboList sourceList = new Common.ComboList();

			if (BlankLine)
			{
                sourceList.Add(new Common.ComboItem(BlankLineText, Guid.Empty));
			}
			
			foreach (FepBatchDetail item in source)
			{
				bool filter = false;
				if (ParentFilter.Trim() != String.Empty)
				{
					filter = true;
					if (item.HeaderId != Guid.Empty)
					{
						filter = IgnorThis(item, ParentFilter);
					}
				}
				if (!(filter))
				{
                    string code = GetFormatedText(item, TextField, TextFormatString);
                    sourceList.Add(new Common.ComboItem(code, item.DetailsId));
				}
			}			

            ddList.DataSource = sourceList;
            ddList.DisplayMember = "Code";
            ddList.ValueMember = "Id";
			
			if (ddList.Items.Count > 0)
			{
			    ddList.SelectedIndex = 0;
            }
		}
		
		#endregion
		
		
		private static bool IgnorThis(FepBatchDetail target, string parentFilter)
		{
			bool result = true;
			parentFilter = parentFilter.Replace(" ", "");		// remove spaces
			parentFilter = parentFilter.Replace("'", "");		// remove '
			string [] parsed = parentFilter.Split('=');			// parse

			if (target.HeaderId == Guid.Empty)
			{
				PropertyInfo pi = target.GetType().GetProperty(parsed[0]);
				string filterField = (string)pi.GetValue(target, null);
				if (filterField.ToLower() == parsed[1].ToLower())
				{
					result = false;
				}
			}
			else
			{
				FepBatchDetail parentTemplate = FepBatchDetail.Load(target.HeaderId);
				result = IgnorThis(parentTemplate, parentFilter);
			}
			return result;
		}

		private static string GetFormatedText(FepBatchDetail target, string [] textField, string textFormatString)
		{
			for (int i = 0; i < textField.Length; i++)
			{
				PropertyInfo pi = target.GetType().GetProperty(textField[i]);
				textFormatString = textFormatString.Replace("{" + i.ToString() +"}", pi != null ? pi.GetValue(target, null).ToString() : string.Empty);
			}
			return textFormatString;
		}
		
		private static string [] GetSwitchLocale(string [] source)
		{
			switch (Common.Config.CurrentLanguageId)
			{
				case 2:
					source[source.Length - 1] += "_Chs";
					break;
				case 3:
					source[source.Length - 1] += "_Cht";
					break;
			}
			return source;
		}
    }


    /// <summary>
    /// Represents a collection of <see cref="FepBatchDetail">FepBatchDetail</see> objects.
    /// </summary>
    public class FepBatchDetailCollection : BindingList< FepBatchDetail>
    {
	}
}
